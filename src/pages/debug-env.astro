---
// è°ƒè¯•ç¯å¢ƒå˜é‡é¡µé¢
import {
  ENV,
  debugEnv,
  isLemonsqueezyConfigured,
} from "../config/lemonsqueezy";

// è°ƒç”¨è°ƒè¯•å‡½æ•°
debugEnv();

const configStatus = isLemonsqueezyConfigured();
const envStatus = {
  hasApiKey: !!ENV.LEMONSQUEEZY_API_KEY,
  hasStoreId: !!ENV.LEMONSQUEEZY_STORE_ID,
  apiKeyLength: ENV.LEMONSQUEEZY_API_KEY?.length || 0,
  storeId: ENV.LEMONSQUEEZY_STORE_ID,
  basicVariant: ENV.LEMONSQUEEZY_BASIC_VARIANT_ID,
  proVariant: ENV.LEMONSQUEEZY_PRO_VARIANT_ID,
  premiumVariant: ENV.LEMONSQUEEZY_PREMIUM_VARIANT_ID,
};

// æ£€æŸ¥åŸå§‹ç¯å¢ƒå˜é‡
const rawEnv = {
  VITE_LEMONSQUEEZY_API_KEY: import.meta.env.VITE_LEMONSQUEEZY_API_KEY,
  VITE_LEMONSQUEEZY_STORE_ID: import.meta.env.VITE_LEMONSQUEEZY_STORE_ID,
  VITE_LEMONSQUEEZY_BASIC_VARIANT_ID: import.meta.env
    .VITE_LEMONSQUEEZY_BASIC_VARIANT_ID,
  VITE_LEMONSQUEEZY_PRO_VARIANT_ID: import.meta.env
    .VITE_LEMONSQUEEZY_PRO_VARIANT_ID,
  VITE_LEMONSQUEEZY_PREMIUM_VARIANT_ID: import.meta.env
    .VITE_LEMONSQUEEZY_PREMIUM_VARIANT_ID,
};
---

<html lang="zh">
  <head>
    <meta charset="utf-8" />
    <title>ç¯å¢ƒå˜é‡è°ƒè¯•</title>
    <style>
      body {
        font-family: monospace;
        padding: 20px;
        background: #1a1a1a;
        color: #fff;
        line-height: 1.6;
      }
      .status {
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
      }
      .success {
        background: #0f5132;
      }
      .error {
        background: #842029;
      }
      .warning {
        background: #664d03;
      }
      pre {
        background: #2a2a2a;
        padding: 15px;
        border-radius: 5px;
        overflow-x: auto;
        white-space: pre-wrap;
      }
      .section {
        margin: 20px 0;
        padding: 15px;
        border: 1px solid #444;
        border-radius: 8px;
      }
    </style>
  </head>
  <body>
    <h1>ğŸ” ç¯å¢ƒå˜é‡è°ƒè¯•é¡µé¢</h1>

    <div class={`status ${configStatus ? "success" : "error"}`}>
      <h2>é…ç½®çŠ¶æ€: {configStatus ? "âœ… æ­£å¸¸" : "âŒ å¼‚å¸¸"}</h2>
    </div>

    <div class="section">
      <h3>ğŸ“‹ å¤„ç†åçš„ç¯å¢ƒå˜é‡ (ENV)</h3>
      <pre>{JSON.stringify(envStatus, null, 2)}</pre>
    </div>

    <div class="section">
      <h3>ğŸ”§ åŸå§‹ç¯å¢ƒå˜é‡ (import.meta.env)</h3>
      <pre>{JSON.stringify(rawEnv, null, 2)}</pre>
    </div>

    <div class="section">
      <h3>ğŸŒ æ‰€æœ‰ç¯å¢ƒå˜é‡</h3>
      <pre>{JSON.stringify(import.meta.env, null, 2)}</pre>
    </div>

    <div class="section">
      <h3>ğŸ§ª æµ‹è¯•ç»“æœ</h3>
      <ul>
        <li>API Key å­˜åœ¨: {envStatus.hasApiKey ? "âœ…" : "âŒ"}</li>
        <li>API Key é•¿åº¦: {envStatus.apiKeyLength}</li>
        <li>Store ID å­˜åœ¨: {envStatus.hasStoreId ? "âœ…" : "âŒ"}</li>
        <li>Store ID å€¼: {envStatus.storeId}</li>
        <li>Basic Variant: {envStatus.basicVariant || "âŒ æœªè®¾ç½®"}</li>
        <li>Pro Variant: {envStatus.proVariant || "âŒ æœªè®¾ç½®"}</li>
        <li>Premium Variant: {envStatus.premiumVariant || "âŒ æœªè®¾ç½®"}</li>
      </ul>
    </div>

    <script>
      console.log("ğŸ” å®¢æˆ·ç«¯è°ƒè¯•ä¿¡æ¯:");
      console.log("é…ç½®çŠ¶æ€:", { configStatus });
      console.log("ENV å¯¹è±¡:", { envStatus });
      console.log("åŸå§‹ç¯å¢ƒå˜é‡:", { rawEnv });
      console.log("æ‰€æœ‰ç¯å¢ƒå˜é‡:", import.meta.env);

      // æµ‹è¯•é…ç½®å‡½æ•°
      import("../config/lemonsqueezy.js")
        .then((module) => {
          console.log("ğŸ§ª é…ç½®æ¨¡å—æµ‹è¯•:");
          console.log("ENV:", module.ENV);
          console.log(
            "isLemonsqueezyConfigured():",
            module.isLemonsqueezyConfigured(),
          );

          // æ‰‹åŠ¨æµ‹è¯•é…ç½®æ£€æŸ¥
          const hasApiKey = !!module.ENV.LEMONSQUEEZY_API_KEY;
          const hasStoreId = !!module.ENV.LEMONSQUEEZY_STORE_ID;
          console.log("æ‰‹åŠ¨æ£€æŸ¥ - API Key:", hasApiKey);
          console.log("æ‰‹åŠ¨æ£€æŸ¥ - Store ID:", hasStoreId);
          console.log("æ‰‹åŠ¨æ£€æŸ¥ - é…ç½®å®Œæ•´:", hasApiKey && hasStoreId);
        })
        .catch((err) => {
          console.error("é…ç½®æ¨¡å—åŠ è½½å¤±è´¥:", err);
        });
    </script>
  </body>
</html>
