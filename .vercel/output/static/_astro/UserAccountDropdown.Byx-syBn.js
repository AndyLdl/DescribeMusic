import{u as b,c as w,a as N,j as e}from"./CreditContext.Cd34fGmH.js";import{r as i}from"./index.D5cfIYOg.js";import{u as k}from"./useSubscription.Cs8u4hSB.js";import{L as C}from"./LoginModal.D24Kv1o2.js";function E({className:l=""}){const{user:r,signOut:g,usageStatus:y}=b(),{subscription:s,isActive:c}=k(),[u,h]=i.useState(!1),[m,n]=i.useState(!1),[v,p]=i.useState(0);let o;try{o=w()}catch{}const{credits:d,creditBalance:a,subscription:L,loading:x}=N(),j=async()=>{try{n(!1),await g(),setTimeout(()=>{window.location.href="/"},100)}catch(t){console.error("Error signing out:",t),n(!1),t?.message==="Auth session missing!"||t?.name==="AuthSessionMissingError"?window.location.href="/":(alert("Sign out completed, but there was a minor issue. You will be redirected."),setTimeout(()=>{window.location.href="/"},1e3))}};if(i.useEffect(()=>{!r&&o?.getTrialCreditBalance&&o.getTrialCreditBalance().then(t=>{t.remaining,p(t.remaining)}).catch(t=>{console.error("Failed to get trial credits in navbar:",t),p(100)})},[r,o]),i.useEffect(()=>{const t=f=>{f.target.closest(".user-dropdown-container")||n(!1)};return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[]),r){const t=l?.includes("mobile-user-dropdown");return e.jsxs("div",{className:`relative user-dropdown-container ${l}`,children:[e.jsxs("button",{onClick:()=>n(!m),className:`flex items-center gap-2 text-sm text-white/90 hover:text-white transition-all duration-300 ${t?"px-2 py-1.5 bg-slate-800/30 hover:bg-slate-700/50 rounded-md":"gap-3 px-3 py-2 bg-slate-800/50 hover:bg-slate-700/50 rounded-md"}`,children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-violet-400 to-blue-400 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:r.email?.charAt(0).toUpperCase()}),!t&&e.jsx("div",{className:"text-left",children:e.jsx("div",{className:"text-white text-sm font-medium",children:x?"Loading...":`${d} Credits`})}),t&&e.jsx("div",{className:"text-white text-xs font-medium",children:x?"...":d}),e.jsx("svg",{className:"w-3 h-3 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),m&&e.jsxs("div",{className:"absolute mt-2 w-72 bg-slate-800/95 backdrop-blur-md border border-slate-700 rounded-lg shadow-xl z-50 right-0",children:[e.jsxs("div",{className:"p-4 border-b border-slate-700",children:[e.jsx("div",{className:"text-white text-sm font-medium",children:r.email}),e.jsx("div",{className:"text-slate-400 text-xs mt-1",children:c&&s?`${s.productName} Subscription`:"Registered User"}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Credit Balance"}),e.jsx("span",{className:"text-sm font-semibold text-green-400",children:x?"...":d})]}),a&&e.jsxs("div",{className:"space-y-1",children:[a.monthly>0&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-slate-500",children:"Monthly Credits"}),e.jsx("span",{className:"text-blue-400",children:a.monthly})]}),a.purchased>0&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-slate-500",children:"Purchased Credits"}),e.jsx("span",{className:"text-violet-400",children:a.purchased})]})]}),c&&s&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-slate-700",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-slate-500",children:"Subscription Status"}),e.jsx("span",{className:`capitalize ${s.status==="active"?"text-green-400":s.status==="cancelled"?"text-red-400":"text-yellow-400"}`,children:s.status==="active"?"Active":s.status==="cancelled"?"Cancelled":s.status==="expired"?"Expired":"Pending"})]}),s.status==="active"&&e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{className:"text-slate-500",children:"Renewal Date"}),e.jsx("span",{className:"text-slate-400",children:s.renewsAt.toLocaleDateString("en-US")})]})]})]})]}),e.jsxs("div",{className:"p-2",children:[e.jsxs("a",{href:"/analyze",className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-slate-300 hover:text-white hover:bg-slate-700/50 rounded-md transition-all duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})}),"Analyze Audio"]}),c?e.jsxs("a",{href:"/pricing",className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-slate-300 hover:text-white hover:bg-slate-700/50 rounded-md transition-all duration-200",children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Manage Subscription"]}):e.jsxs("a",{href:"/pricing",className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-slate-300 hover:text-white hover:bg-slate-700/50 rounded-md transition-all duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),"Purchase Credits"]}),e.jsxs("button",{onClick:j,className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-slate-300 hover:text-white hover:bg-slate-700/50 rounded-md transition-all duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})]})]})]})}else return e.jsxs("div",{className:`flex items-center gap-3 ${l}`,children:[e.jsxs("a",{href:"/analyze/",className:"hidden sm:flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-500/10 to-violet-500/10 border border-blue-500/20 hover:border-blue-500/40 rounded-lg backdrop-blur-sm transition-all duration-300 group",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400 group-hover:text-blue-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-blue-400 group-hover:text-blue-300 text-sm font-semibold transition-colors",children:[v," Credits"]}),e.jsx("span",{className:"text-slate-400 group-hover:text-slate-300 text-xs transition-colors",children:"Click to start"})]}),e.jsx("svg",{className:"w-3 h-3 text-slate-400 group-hover:text-slate-300 group-hover:translate-x-0.5 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),e.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),h(!0)},"data-login-trigger":!0,className:"px-4 py-2 text-white bg-slate-700/50 hover:bg-slate-600/50 border border-slate-600 hover:border-slate-500 rounded-lg transition-all duration-300 text-sm font-medium backdrop-blur-sm",children:"Sign In"}),u&&e.jsx(C,{isOpen:u,onClose:()=>{h(!1)}})]})}export{E as U};
